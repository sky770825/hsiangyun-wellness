# 專案改進與調整方案（十項以上）

以下依**優先度與影響範圍**整理，便於排程與實作。

---

## 一、安全與權限

### 1. 後台登入保護
- **現況**：`/admin` 任何人皆可進入，預約、CRM、媒體、主題等皆可被改動。
- **建議**：接 Supabase Auth（或其它 IdP），新增 `ProtectedRoute`；未登入導向登入頁，登入後才可存取 `/admin/*`。
- **效益**：避免資料被任意修改或刪除。

### 2. 預約與個資保護
- **現況**：預約表單僅前端驗證，資料存 localStorage，無隱私聲明與同意勾選。
- **建議**：
  - 新增「隱私權政策」頁，表單加「我已閱讀並同意隱私權政策」勾選（必選才能送出）。
  - 預約改為送後端 API（如 Supabase），並在後端驗證 email 格式、長度與必填。
- **效益**：符合個資與隱私期待，資料有備份且可跨裝置。

---

## 二、資料持久化與後端

### 3. 預約、CRM、任務、推播改為資料庫
- **現況**：預約、學員、任務、推播皆存於 localStorage，換裝置或清除快取即消失。
- **建議**：接 Supabase（或自建 API），建立 `bookings`、`students`、`tasks`、`push_messages` 等表；`admin/store.ts` 改為呼叫 API，前端僅負責顯示與表單送出。
- **效益**：資料永久保存、可多裝置同步、利於備份與分析。

### 4. 媒體庫改為雲端儲存
- **現況**：上傳圖片存成 blob / object URL，關閉分頁可能失效，容量受限。
- **建議**：接 Supabase Storage（或 S3 等），上傳後取得公開 URL 寫入媒體表；形象照、故事圖、輪播圖皆改為讀取該 URL。
- **效益**：圖片穩定、可跨裝置、易於與後台編輯流程整合。

### 5. 網站主題改為後端或 API 讀取
- **現況**：主題（字形、字級、顏色）僅存 localStorage，多裝置不同步。
- **建議**：主題寫入 Supabase 的 `site_settings` 或 `theme` 表，前台與後台皆從 API 讀寫；或保留 localStorage 作為快取，但以 API 為準。
- **效益**：多裝置一致、可做版本或還原。

---

## 三、使用者體驗（UX）

### 6. 預約表單：loading 與防重複送出
- **現況**：送出後無 loading，使用者可能多次點擊。
- **建議**：送出時按鈕改為 disabled、顯示 loading（轉圈或文案）；成功後可提供「再預約一筆」清空表單重新填寫。
- **效益**：減少重複資料、操作回饋更明確。

### 7. 後台操作回饋與二次確認
- **現況**：媒體刪除、推播發送等無確認；儲存／刪除後無 toast。
- **建議**：刪除與發送前用 `AlertDialog` 二次確認；儲存／刪除／發送成功或失敗皆用 toast 提示。
- **效益**：降低誤操作、管理員清楚知道動作是否成功。

### 8. 後台空狀態引導
- **現況**：預約、CRM、任務、推播無資料時僅一行文字。
- **建議**：空狀態改為簡短引導（例如「建立第一筆預約／學員／任務／推播」）並提供主要操作按鈕。
- **效益**：新使用者較易上手。

---

## 四、SEO 與可發現性

### 9. 每頁獨立 title 與 description
- **現況**：全站共用 `index.html` 的單一 title，無 description、無每頁差異。
- **建議**：依路由設定每頁的 `document.title` 與 `<meta name="description">`（可用 `react-helmet-async` 或自訂 hook），並在 `index.html` 設好預設 description。
- **效益**：搜尋結果與分享連結時顯示正確標題與描述。

### 10. 麵包屑與結構化資料（選做）
- **現況**：內頁無麵包屑，無 Schema.org 等結構化資料。
- **建議**：在 PageLayout 或各內頁加麵包屑（首頁 > 關於我 / 學員故事 等），路徑從 `ROUTES` 讀取；若有部落格或固定內容，可考慮 JSON-LD。
- **效益**：導航與搜尋引擎理解網站結構較容易。

---

## 五、穩定性與錯誤處理

### 11. 全域錯誤邊界（Error Boundary）
- **現況**：任一元件拋錯可能導致整頁白屏。
- **建議**：用 React Error Boundary 包住路由或整站，出錯時顯示友善錯誤頁（含「重新整理」或「返回首頁」），並可選擇將錯誤上報（如 Supabase 或 log 服務）。
- **效益**：單一元件錯誤不影響整站，利於除錯與監控。

### 12. 圖片載入失敗 fallback
- **現況**：故事、照片牆、媒體庫若圖片 URL 失效會破圖。
- **建議**：所有 `<img>` 加上 `onError`，失敗時改顯示預設圖或佔位圖（可共用 `placeholder.svg` 或統一 fallback 元件）。
- **效益**：連結錯誤或 CDN 問題時仍保持版面完整。

---

## 六、效能與載入

### 13. 圖片懶載入與尺寸優化
- **現況**：故事、照片牆、短影音輪播未使用 `loading="lazy"`，大圖可能一次全載。
- **建議**：非首屏圖片加 `loading="lazy"`；若有多尺寸需求可考慮 `srcset` 或之後接 CDN 自動縮圖。
- **效益**：首屏載入較快、流量較省。

### 14. 學員故事／短影音區塊 lazy 或按需載入
- **現況**：TikTok iframe 與多張圖可能一次載入。
- **建議**：輪播或照片牆可改為「進入視窗再掛 iframe / 載圖」；或短影音區塊用 Intersection Observer 延後載入。
- **效益**：首屏更輕、第三方 iframe 不拖慢主站。

---

## 七、無障礙（a11y）

### 15. 鍵盤與焦點、aria 補齊
- **現況**：部分互動元件（輪播、自訂按鈕）可能缺 `aria-label`、鍵盤操作或 focus 可見樣式。
- **建議**：為主要按鈕與連結補上 `aria-label` 或適當 `role`；確保輪播、表單可用鍵盤操作；focus 時有明顯 outline 或 ring。
- **效益**：鍵盤與螢幕閱讀器使用者體驗更好，也利於通過基本 a11y 檢查。

---

## 八、功能補齊

### 16. 免費下載 PDF 實際檔案與訂閱管道
- **現況**：「免費下載 PDF」僅顯示 toast；「訂閱每日語錄」僅捲動到語錄區。
- **建議**：將「鬆動設定點的三個小行動」做成 PDF 放 `public/` 或 CDN，按鈕改為下載連結；訂閱可改為表單收 email 寫入 Supabase，或連結到 Line／IG 等。
- **效益**：承諾的資源可兌現，訂閱可後續行銷或發送語錄。

### 17. 測驗流程（假瘦語言類型）
- **現況**：「開始測驗」僅捲動到測驗區，無實際題目與結果。
- **建議**：新增測驗頁或區塊：數題選擇題 → 依答案分類出「假瘦語言類型」→ 結果頁可引導至預約或資源；題目與結果文案可放 `data/` 或後台。
- **效益**：增加互動與停留時間，並自然導向預約。

### 18. 推播實際發送
- **現況**：後台「發送」僅將狀態改為 sent，未呼叫推播服務。
- **建議**：接 Firebase Cloud Messaging 或 OneSignal 等，後台發送時呼叫對應 API，並可記錄已送達／已讀（若服務支援）。
- **效益**：真正能對學員或訂閱者發送提醒或內容。

---

## 九、營運與維運

### 19. 預約／表單通知
- **現況**：新預約僅寫入前端 store（或未來 DB），教練不會即時得知。
- **建議**：新預約寫入 DB 後，以 Supabase Edge Function 或後端發送 Email／Line 通知教練；可選：同時回覆一封「我們已收到預約」給填表者。
- **效益**：即時跟單、減少漏單。

### 20. 後台簡單數據統計
- **現況**：總覽僅顯示待處理預約數、進行中學員數等，無趨勢或分布。
- **建議**：在總覽或各模組加簡單統計：預約狀態分布、學員狀態分布、任務完成率、推播送達數等（資料來源改為 DB 後即可查詢）。
- **效益**：一眼掌握營運狀況，方便調整策略。

---

## 十、程式與維修品質

### 21. 環境變數與設定集中
- **現況**：API 網址、Supabase 等若未來接入，易散落各檔。
- **建議**：使用 `.env`（或 Vite `import.meta.env`）集中 API URL、Supabase anon key 等；在文件中說明必要變數，並將 `.env.example` 加入版控範本。
- **效益**：開發／正式環境分離、敏感資訊不進版控。

### 22. 單元與整合測試補強
- **現況**：僅有範例測試，表單、store、關鍵流程未覆蓋。
- **建議**：為預約送出、store 讀寫、路由與關鍵頁面渲染撰寫測試（Vitest + React Testing Library）；可先從「預約表單送出後資料格式正確」與「後台讀取到新預約」等情境開始。
- **效益**：重構或改版時較敢改、回歸問題較少。

---

## 優先順序建議（簡表）

| 優先 | 項目編號 | 說明 |
|------|----------|------|
| 高 | 1, 2, 3 | 後台登入、個資/隱私、預約進 DB |
| 高 | 4, 5 | 媒體雲端、主題從 API |
| 中 | 6, 7, 8 | 表單 UX、後台確認與 toast、空狀態 |
| 中 | 9, 11, 12 | 每頁 SEO、Error Boundary、圖片 fallback |
| 中 | 16, 17, 18 | PDF/訂閱、測驗、推播實際發送 |
| 中 | 19, 20 | 預約通知、後台統計 |
| 低 | 10, 13, 14, 15 | 麵包屑、懶載入、a11y 補齊 |
| 低 | 21, 22 | 環境變數、測試補強 |

以上共 **22 項** 改進與調整方案，可依資源與時程從高優先開始實作，並與既有 `docs/CHECKLIST.md` 對照使用。
